A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(A0_vm);
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(A1_vm);
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-8.75, 8.25), ylim = c(-8.5,8.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
x0 <- sqrt(1000) * sd(A0vec) * cos(vl) + mean(diag(A0));
y0 <- sqrt(1000) * sd(A0vec) * sin(vl);
x1 <- sqrt(1000) * sd(A1vec) * cos(vl) + mean(diag(A1));
y1 <- sqrt(1000) * sd(A1vec) * sin(vl);
text(x = -8.5, y = 10, labels = "a", cex = 2);
points(x = x0, y = y0, type = "l", lwd = 3);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3, lty = "dashed");
plot(A1_r, A1_i, xlim = c(-8.75, 8.25), ylim = c(-8.5,8.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1, col = "red",
yaxt = "n");
text(x = -8.5, y = 10, labels = "b", cex = 2);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3)
points(x = x0, y = y0, type = "l", lwd = 3, lty = "dashed");
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
A_comp <- NULL;
A_dat  <- rnorm(n = 1000000, mean = 0, sd = 0.4);
A_mat  <- matrix(data = A_dat, nrow = 1000);
C_dat  <- rbinom(n = 1000 * 1000, size = 1, prob = 1);
C_mat  <- matrix(data = C_dat, nrow = 1000, ncol = 1000);
A_mat     <- A_mat * C_mat;
gammas <- runif(n = 1000, min = 0, max = 2);
mu_gam <- mean(gammas);
diag(A_mat) <- -1;
A1     <- gammas * A_mat;
A0     <- mu_gam * A_mat;
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(A0_vm);
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(A1_vm);
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-18.75, 18.25), ylim = c(-18.5,18.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
x0 <- sqrt(1000) * sd(A0vec) * cos(vl) + mean(diag(A0));
y0 <- sqrt(1000) * sd(A0vec) * sin(vl);
x1 <- sqrt(1000) * sd(A1vec) * cos(vl) + mean(diag(A1));
y1 <- sqrt(1000) * sd(A1vec) * sin(vl);
text(x = -9.5, y = 8, labels = "a", cex = 2);
points(x = x0, y = y0, type = "l", lwd = 3);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3, lty = "dashed");
plot(A1_r, A1_i, xlim = c(-8.75, 8.25), ylim = c(-8.5,8.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1, col = "red",
yaxt = "n");
text(x = -9.5, y = 8, labels = "b", cex = 2);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3)
points(x = x0, y = y0, type = "l", lwd = 3, lty = "dashed");
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
A_comp <- NULL;
A_dat  <- rnorm(n = 1000000, mean = 0, sd = 0.4);
A_mat  <- matrix(data = A_dat, nrow = 1000);
C_dat  <- rbinom(n = 1000 * 1000, size = 1, prob = 1);
C_mat  <- matrix(data = C_dat, nrow = 1000, ncol = 1000);
A_mat     <- A_mat * C_mat;
gammas <- runif(n = 1000, min = 0, max = 2);
mu_gam <- mean(gammas);
diag(A_mat) <- -1;
A1     <- gammas * A_mat;
A0     <- mu_gam * A_mat;
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(A0_vm);
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(A1_vm);
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-16.75, 16.25), ylim = c(-16.5,16.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
x0 <- sqrt(1000) * sd(A0vec) * cos(vl) + mean(diag(A0));
y0 <- sqrt(1000) * sd(A0vec) * sin(vl);
x1 <- sqrt(1000) * sd(A1vec) * cos(vl) + mean(diag(A1));
y1 <- sqrt(1000) * sd(A1vec) * sin(vl);
text(x = -9.5, y = 8, labels = "a", cex = 2);
points(x = x0, y = y0, type = "l", lwd = 3);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3, lty = "dashed");
plot(A1_r, A1_i, xlim = c(-16.75, 16.25), ylim = c(-16.5,16.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1, col = "red",
yaxt = "n");
text(x = -9.5, y = 8, labels = "b", cex = 2);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3)
points(x = x0, y = y0, type = "l", lwd = 3, lty = "dashed");
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
A_comp <- NULL;
A_dat  <- rnorm(n = 1000000, mean = 0, sd = 0.4);
A_mat  <- matrix(data = A_dat, nrow = 1000);
C_dat  <- rbinom(n = 1000 * 1000, size = 1, prob = 1);
C_mat  <- matrix(data = C_dat, nrow = 1000, ncol = 1000);
A_mat     <- A_mat * C_mat;
gammas <- runif(n = 1000, min = 0, max = 2);
mu_gam <- mean(gammas);
diag(A_mat) <- -1;
A1     <- gammas * A_mat;
A0     <- mu_gam * A_mat;
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(A0_vm);
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(A1_vm);
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-16.75, 16.25), ylim = c(-16.5,16.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
x0 <- sqrt(1000) * sd(A0vec) * cos(vl) + mean(diag(A0));
y0 <- sqrt(1000) * sd(A0vec) * sin(vl);
x1 <- sqrt(1000) * sd(A1vec) * cos(vl) + mean(diag(A1));
y1 <- sqrt(1000) * sd(A1vec) * sin(vl);
text(x = -19, y = 14, labels = "a", cex = 2);
points(x = x0, y = y0, type = "l", lwd = 3);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3, lty = "dashed");
plot(A1_r, A1_i, xlim = c(-16.75, 16.25), ylim = c(-16.5,16.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1, col = "red",
yaxt = "n");
text(x = -19, y = 14, labels = "b", cex = 2);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3)
points(x = x0, y = y0, type = "l", lwd = 3, lty = "dashed");
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
A_comp <- NULL;
A_dat  <- rnorm(n = 1000000, mean = 0, sd = 0.4);
A_mat  <- matrix(data = A_dat, nrow = 1000);
C_dat  <- rbinom(n = 1000 * 1000, size = 1, prob = 1);
C_mat  <- matrix(data = C_dat, nrow = 1000, ncol = 1000);
A_mat     <- A_mat * C_mat;
gammas <- runif(n = 1000, min = 0, max = 2);
mu_gam <- mean(gammas);
diag(A_mat) <- -1;
A1     <- gammas * A_mat;
A0     <- mu_gam * A_mat;
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(A0_vm);
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(A1_vm);
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-16.75, 16.25), ylim = c(-16.5,16.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
x0 <- sqrt(1000) * sd(A0vec) * cos(vl) + mean(diag(A0));
y0 <- sqrt(1000) * sd(A0vec) * sin(vl);
x1 <- sqrt(1000) * sd(A1vec) * cos(vl) + mean(diag(A1));
y1 <- sqrt(1000) * sd(A1vec) * sin(vl);
text(x = -19, y = 14, labels = "a", cex = 2);
points(x = x0, y = y0, type = "l", lwd = 3);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3, lty = "dashed");
plot(A1_r, A1_i, xlim = c(-16.75, 16.25), ylim = c(-16.5,16.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1, col = "red",
yaxt = "n");
text(x = -19, y = 14, labels = "b", cex = 2);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3)
points(x = x0, y = y0, type = "l", lwd = 3, lty = "dashed");
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
A_comp <- NULL;
A_dat  <- rnorm(n = 1000000, mean = 0, sd = 0.4);
A_mat  <- matrix(data = A_dat, nrow = 1000);
C_dat  <- rbinom(n = 1000 * 1000, size = 1, prob = 1);
C_mat  <- matrix(data = C_dat, nrow = 1000, ncol = 1000);
A_mat     <- A_mat * C_mat;
gammas <- runif(n = 1000, min = 0, max = 2);
mu_gam <- mean(gammas);
diag(A_mat) <- -1;
A1     <- gammas * A_mat;
A0     <- mu_gam * A_mat;
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(A0_vm);
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(A1_vm);
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-16.75, 16.25), ylim = c(-16.5,16.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
x0 <- sqrt(1000) * sd(A0vec) * cos(vl) + mean(diag(A0));
y0 <- sqrt(1000) * sd(A0vec) * sin(vl);
x1 <- sqrt(1000) * sd(A1vec) * cos(vl) + mean(diag(A1));
y1 <- sqrt(1000) * sd(A1vec) * sin(vl);
text(x = -19, y = 14, labels = "a", cex = 2);
points(x = x0, y = y0, type = "l", lwd = 3);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3, lty = "dashed");
plot(A1_r, A1_i, xlim = c(-16.75, 16.25), ylim = c(-16.5,16.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1, col = "red",
yaxt = "n");
text(x = -19, y = 14, labels = "b", cex = 2);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3)
points(x = x0, y = y0, type = "l", lwd = 3, lty = "dashed");
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
sqrt(1000)
sqrt(1000) * 0.4
mean(x0)
species_interactions <- function(mat, type = 0){
if(type == 1){
mat[mat > 0] <- -1*mat[mat > 0];
}
if(type == 2){
mat[mat < 0] <- -1*mat[mat < 0];
}
if(type == 3){
for(i in 1:dim(mat)[1]){
for(j in 1:dim(mat)[2]){
if(mat[i, j] * mat[j, i] > 0){
mat[j, i] <- -1 * mat[j, i];
}
}
}
}
return(mat);
}
summarise_randmat <- function(tot_res, fea_res){
sims    <- length(tot_res);
all_res <- matrix(data = 0, nrow = sims, ncol = 37);
for(i in 1:sims){
all_res[i, 1]  <- i + 1;
# Stable and unstable
all_res[i, 2]  <- sum(tot_res[[i]][,1] == FALSE);
all_res[i, 3]  <- sum(tot_res[[i]][,1] == TRUE);
all_res[i, 4]  <- sum(tot_res[[i]][,2] == FALSE);
all_res[i, 5]  <- sum(tot_res[[i]][,2] == TRUE);
# Stabilised and destabilised
all_res[i, 6] <- sum(tot_res[[i]][,1] == FALSE &
tot_res[[i]][,2] == TRUE);
all_res[i, 7] <- sum(tot_res[[i]][,1] == TRUE &
tot_res[[i]][,2] == FALSE);
# Feasible and infeasible
all_res[i, 8]  <- sum(fea_res[[i]][,1] == FALSE);
all_res[i, 9]  <- sum(fea_res[[i]][,1] == TRUE);
all_res[i, 10]  <- sum(fea_res[[i]][,2] == FALSE);
all_res[i, 11]  <- sum(fea_res[[i]][,2] == TRUE);
# Feased and defeased
all_res[i, 12] <- sum(fea_res[[i]][,1] == FALSE &
fea_res[[i]][,2] == TRUE);
all_res[i, 13] <- sum(fea_res[[i]][,1] == TRUE &
fea_res[[i]][,2] == FALSE);
}
cnames <- c("N", "A0_unstable", "A0_stable", "A1_unstable", "A1_stable",
"A1_stabilised", "A1_destabilised", "A0_infeasible",
"A0_feasible", "A1_infeasible", "A1_feasible",
"A1_made_feasible", "A1_made_infeasible");
colnames(all_res) <- cnames;
return(all_res);
}
rand_gen_var <- function(max_sp, iters, int_type = 0, rmx = 0.4, C = 1){
tot_res <- NULL;
fea_res <- NULL;
for(i in 2:max_sp){
iter           <- iters;
tot_res[[i-1]] <- matrix(data = 0, nrow = iter, ncol = 7);
fea_res[[i-1]] <- matrix(data = 0, nrow = iter, ncol = 7);
while(iter > 0){
r_vec    <- rnorm(n = i, mean = 0, sd = rmx);
A0_dat   <- rnorm(n = i * i, mean = 0, sd = 0.4);
A0       <- matrix(data = A0_dat, nrow = i, ncol = i);
A0       <- species_interactions(mat = A0, type = int_type);
C_dat    <- rbinom(n = i * i, size = 1, prob = C);
C_mat    <- matrix(data = C_dat, nrow = i, ncol = i);
A0       <- A0 * C_mat;
diag(A0) <- -1;
gam0     <- runif(n = i, min = 0, max = 2);
A1       <- A0 * gam1;
A0       <- A0 * mean(gam0);
A0_stb   <- max(Re(eigen(A0)$values)) < 0;
A1_stb   <- max(Re(eigen(A1)$values)) < 0;
A0_fea   <- min(-1*solve(A0) %*% r_vec) > 0;
if(A0_stb == TRUE){
tot_res[[i-1]][iter, 1] <- 1;
}
if(A1_stb == TRUE){
tot_res[[i-1]][iter, 2] <- 1;
}
if(A0_fea == TRUE){
fea_res[[i-1]][iter, 1] <- 1;
}
if(A1_fea == TRUE){
fea_res[[i-1]][iter, 2] <- 1;
}
iter    <- iter - 1;
}
print(i);
}
all_res <- summarise_randmat(tot_res = tot_res, fea_res = fea_res);
return(all_res);
}
rand_gen_var(max_sp = 10, iters = 100)
rand_gen_var <- function(max_sp, iters, int_type = 0, rmx = 0.4, C = 1){
tot_res <- NULL;
fea_res <- NULL;
for(i in 2:max_sp){
iter           <- iters;
tot_res[[i-1]] <- matrix(data = 0, nrow = iter, ncol = 7);
fea_res[[i-1]] <- matrix(data = 0, nrow = iter, ncol = 7);
while(iter > 0){
r_vec    <- rnorm(n = i, mean = 0, sd = rmx);
A0_dat   <- rnorm(n = i * i, mean = 0, sd = 0.4);
A0       <- matrix(data = A0_dat, nrow = i, ncol = i);
A0       <- species_interactions(mat = A0, type = int_type);
C_dat    <- rbinom(n = i * i, size = 1, prob = C);
C_mat    <- matrix(data = C_dat, nrow = i, ncol = i);
A0       <- A0 * C_mat;
diag(A0) <- -1;
gam1     <- runif(n = i, min = 0, max = 2);
A1       <- A0 * gam1;
A0       <- A0 * mean(gam1);
A0_stb   <- max(Re(eigen(A0)$values)) < 0;
A1_stb   <- max(Re(eigen(A1)$values)) < 0;
A0_fea   <- min(-1*solve(A0) %*% r_vec) > 0;
if(A0_stb == TRUE){
tot_res[[i-1]][iter, 1] <- 1;
}
if(A1_stb == TRUE){
tot_res[[i-1]][iter, 2] <- 1;
}
if(A0_fea == TRUE){
fea_res[[i-1]][iter, 1] <- 1;
}
if(A1_fea == TRUE){
fea_res[[i-1]][iter, 2] <- 1;
}
iter    <- iter - 1;
}
print(i);
}
all_res <- summarise_randmat(tot_res = tot_res, fea_res = fea_res);
return(all_res);
}
rand_gen_var(max_sp = 10, iters = 100)
rand_gen_var <- function(max_sp, iters, int_type = 0, rmx = 0.4, C = 1){
tot_res <- NULL;
fea_res <- NULL;
for(i in 2:max_sp){
iter           <- iters;
tot_res[[i-1]] <- matrix(data = 0, nrow = iter, ncol = 7);
fea_res[[i-1]] <- matrix(data = 0, nrow = iter, ncol = 7);
while(iter > 0){
r_vec    <- rnorm(n = i, mean = 0, sd = rmx);
A0_dat   <- rnorm(n = i * i, mean = 0, sd = 0.4);
A0       <- matrix(data = A0_dat, nrow = i, ncol = i);
A0       <- species_interactions(mat = A0, type = int_type);
C_dat    <- rbinom(n = i * i, size = 1, prob = C);
C_mat    <- matrix(data = C_dat, nrow = i, ncol = i);
A0       <- A0 * C_mat;
diag(A0) <- -1;
gam1     <- runif(n = i, min = 0, max = 2);
A1       <- A0 * gam1;
A0       <- A0 * mean(gam1);
A0_stb   <- max(Re(eigen(A0)$values)) < 0;
A1_stb   <- max(Re(eigen(A1)$values)) < 0;
A0_fea   <- min(-1*solve(A0) %*% r_vec) > 0;
A1_fea   <- min(-1*solve(A1) %*% r_vec) > 0;
if(A0_stb == TRUE){
tot_res[[i-1]][iter, 1] <- 1;
}
if(A1_stb == TRUE){
tot_res[[i-1]][iter, 2] <- 1;
}
if(A0_fea == TRUE){
fea_res[[i-1]][iter, 1] <- 1;
}
if(A1_fea == TRUE){
fea_res[[i-1]][iter, 2] <- 1;
}
iter    <- iter - 1;
}
print(i);
}
all_res <- summarise_randmat(tot_res = tot_res, fea_res = fea_res);
return(all_res);
}
rand_gen_var(max_sp = 10, iters = 100)
summarise_randmat <- function(tot_res, fea_res){
sims    <- length(tot_res);
all_res <- matrix(data = 0, nrow = sims, ncol = 13);
for(i in 1:sims){
all_res[i, 1]  <- i + 1;
# Stable and unstable
all_res[i, 2]  <- sum(tot_res[[i]][,1] == FALSE);
all_res[i, 3]  <- sum(tot_res[[i]][,1] == TRUE);
all_res[i, 4]  <- sum(tot_res[[i]][,2] == FALSE);
all_res[i, 5]  <- sum(tot_res[[i]][,2] == TRUE);
# Stabilised and destabilised
all_res[i, 6] <- sum(tot_res[[i]][,1] == FALSE &
tot_res[[i]][,2] == TRUE);
all_res[i, 7] <- sum(tot_res[[i]][,1] == TRUE &
tot_res[[i]][,2] == FALSE);
# Feasible and infeasible
all_res[i, 8]  <- sum(fea_res[[i]][,1] == FALSE);
all_res[i, 9]  <- sum(fea_res[[i]][,1] == TRUE);
all_res[i, 10]  <- sum(fea_res[[i]][,2] == FALSE);
all_res[i, 11]  <- sum(fea_res[[i]][,2] == TRUE);
# Feased and defeased
all_res[i, 12] <- sum(fea_res[[i]][,1] == FALSE &
fea_res[[i]][,2] == TRUE);
all_res[i, 13] <- sum(fea_res[[i]][,1] == TRUE &
fea_res[[i]][,2] == FALSE);
}
cnames <- c("N", "A0_unstable", "A0_stable", "A1_unstable", "A1_stable",
"A1_stabilised", "A1_destabilised", "A0_infeasible",
"A0_feasible", "A1_infeasible", "A1_feasible",
"A1_made_feasible", "A1_made_infeasible");
colnames(all_res) <- cnames;
return(all_res);
}
rand_gen_var(max_sp = 10, iters = 100)
A_comp <- NULL;
A_dat  <- rnorm(n = 1000000, mean = 0, sd = 0.4);
A_mat  <- matrix(data = A_dat, nrow = 1000);
C_dat  <- rbinom(n = 1000 * 1000, size = 1, prob = 1);
C_mat  <- matrix(data = C_dat, nrow = 1000, ncol = 1000);
A_mat     <- A_mat * C_mat;
gammas <- runif(n = 1000, min = 0, max = 2);
mu_gam <- mean(gammas);
diag(A_mat) <- -1;
A1     <- gammas * A_mat;
A0     <- mu_gam * A_mat;
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(A0_vm);
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(A1_vm);
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-16.5, 15.5), ylim = c(-16.5,15.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
x0 <- sqrt(1000) * sd(A0vec) * cos(vl) + mean(diag(A0));
y0 <- sqrt(1000) * sd(A0vec) * sin(vl);
x1 <- sqrt(1000) * sd(A1vec) * cos(vl) + mean(diag(A1));
y1 <- sqrt(1000) * sd(A1vec) * sin(vl);
text(x = -15.5, y = 19, labels = "a", cex = 2);
points(x = x0, y = y0, type = "l", lwd = 3);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3, lty = "dashed");
plot(A1_r, A1_i, xlim = c(-16.5, 15.5), ylim = c(-16.5,15.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1, col = "red",
yaxt = "n");
text(x = -15.5, y = 19, labels = "b", cex = 2);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3)
points(x = x0, y = y0, type = "l", lwd = 3, lty = "dashed");
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
sum(A1_r < 0)
sum(A0_r < 0)
sum(A0_r < 0) / length(A0_r);
sum(A1_r < 0) / length(A1_r);
