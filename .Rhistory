diag(A1_vm) <- NA;
A1vec       <- as.vector(t(A1_vm));
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-3.7, 1), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
A0x0 <- sqrt(200) * sd(A0vec) * cos(vl) + mean(diag(A0));
A0y0 <- sqrt(200) * sd(A0vec) * sin(vl);
text(x = -3.25, y = 3.5, labels = "a", cex = 2);
points(x = A0x0, y = A0y0, type = "l", lwd = 3, col = "grey");
plot(A1_r, A1_i, xlim = c(-3.7, 1), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1,
col = "red", yaxt = "n");
vl <- seq(from = 0, to = 2*pi, by = 0.001);
fhalf <- 1:(0.5*length(A1vec));
shalf <- (0.5*length(A1vec)+1):length(A1vec);
A0x1a <- sqrt(100) * sd(A1vec[fhalf]) * cos(vl) + mean(diag(A1)[1:100]);
A0y1a <- sqrt(100) * sd(A1vec[fhalf]) * sin(vl);
points(x = A0x1a, y = A0y1a, type = "l", lwd = 3, col = "red");
A0x1b <- sqrt(100) * sd(A1vec[shalf]) * cos(vl) + mean(diag(A1)[101:200]);
A0y1b <- sqrt(100) * sd(A1vec[shalf]) * sin(vl);
points(x = A0x1b, y = A0y1b, type = "l", lwd = 3, col = "orange");
text(x = -3.25, y = 3.5, labels = "b", cex = 2);
points(x = x0, y = y0, type = "l", lwd = 3, lty = "dashed");
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
A0 <- read.csv(file = "../sim_results/bi_gamma/S200_A0.csv");
A0 <- as.matrix(A0[,-1]);
A1 <- read.csv(file = "../sim_results/bi_gamma/S200_A1.csv");
A1 <- as.matrix(A1[,-1]);
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(t(A0_vm));
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(t(A1_vm));
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-3.7, 1), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
A0x0 <- sqrt(200) * sd(A0vec) * cos(vl) + mean(diag(A0));
A0y0 <- sqrt(200) * sd(A0vec) * sin(vl);
text(x = -3.25, y = 3.5, labels = "a", cex = 2);
points(x = A0x0, y = A0y0, type = "l", lwd = 3, col = "grey");
plot(A1_r, A1_i, xlim = c(-3.7, 1), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1,
col = "red", yaxt = "n");
vl <- seq(from = 0, to = 2*pi, by = 0.001);
fhalf <- 1:(0.5*length(A1vec));
shalf <- (0.5*length(A1vec)+1):length(A1vec);
A0x1a <- sqrt(100) * sd(A1vec[fhalf]) * cos(vl) + mean(diag(A1)[1:100]);
A0y1a <- sqrt(100) * sd(A1vec[fhalf]) * sin(vl);
points(x = A0x1a, y = A0y1a, type = "l", lwd = 3, col = "pink");
A0x1b <- sqrt(100) * sd(A1vec[shalf]) * cos(vl) + mean(diag(A1)[101:200]);
A0y1b <- sqrt(100) * sd(A1vec[shalf]) * sin(vl);
points(x = A0x1b, y = A0y1b, type = "l", lwd = 3, col = "pink");
text(x = -3.25, y = 3.5, labels = "b", cex = 2);
points(x = x0, y = y0, type = "l", lwd = 3, lty = "dashed", col = "grey");
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
A0 <- read.csv(file = "../sim_results/bi_gamma/S200_A0.csv");
A0 <- as.matrix(A0[,-1]);
A1 <- read.csv(file = "../sim_results/bi_gamma/S200_A1.csv");
A1 <- as.matrix(A1[,-1]);
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(t(A0_vm));
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(t(A1_vm));
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-3.7, 1), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
A0x0 <- sqrt(200) * sd(A0vec) * cos(vl) + mean(diag(A0));
A0y0 <- sqrt(200) * sd(A0vec) * sin(vl);
text(x = -3.25, y = 3.5, labels = "a", cex = 2);
points(x = A0x0, y = A0y0, type = "l", lwd = 3, col = "grey");
points(A0_r, A0_i, pch = 4, cex = 0.7);
plot(A1_r, A1_i, xlim = c(-3.7, 1), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1,
col = "red", yaxt = "n");
vl <- seq(from = 0, to = 2*pi, by = 0.001);
fhalf <- 1:(0.5*length(A1vec));
shalf <- (0.5*length(A1vec)+1):length(A1vec);
A0x1a <- sqrt(100) * sd(A1vec[fhalf]) * cos(vl) + mean(diag(A1)[1:100]);
A0y1a <- sqrt(100) * sd(A1vec[fhalf]) * sin(vl);
points(x = A0x1a, y = A0y1a, type = "l", lwd = 3, col = "pink");
A0x1b <- sqrt(100) * sd(A1vec[shalf]) * cos(vl) + mean(diag(A1)[101:200]);
A0y1b <- sqrt(100) * sd(A1vec[shalf]) * sin(vl);
points(x = A0x1b, y = A0y1b, type = "l", lwd = 3, col = "pink");
text(x = -3.25, y = 3.5, labels = "b", cex = 2);
points(x = x0, y = y0, type = "l", lwd = 3, lty = "dashed", col = "grey");
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
A0 <- read.csv(file = "../sim_results/bi_gamma/S200_A0.csv");
A0 <- as.matrix(A0[,-1]);
A1 <- read.csv(file = "../sim_results/bi_gamma/S200_A1.csv");
A1 <- as.matrix(A1[,-1]);
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(t(A0_vm));
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(t(A1_vm));
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
A0x0 <- sqrt(200) * sd(A0vec) * cos(vl) + mean(diag(A0));
A0y0 <- sqrt(200) * sd(A0vec) * sin(vl);
text(x = -3.25, y = 3.5, labels = "a", cex = 2);
points(x = A0x0, y = A0y0, type = "l", lwd = 3, col = "grey");
points(A0_r, A0_i, pch = 4, cex = 0.7);
plot(A1_r, A1_i, xlim = c(-3.7, 1), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1,
col = "black", yaxt = "n");
vl <- seq(from = 0, to = 2*pi, by = 0.001);
fhalf <- 1:(0.5*length(A1vec));
shalf <- (0.5*length(A1vec)+1):length(A1vec);
A0x1a <- sqrt(100) * sd(A1vec[fhalf]) * cos(vl) + mean(diag(A1)[1:100]);
A0y1a <- sqrt(100) * sd(A1vec[fhalf]) * sin(vl);
points(x = A0x1a, y = A0y1a, type = "l", lwd = 3, col = "grey");
A0x1b <- sqrt(100) * sd(A1vec[shalf]) * cos(vl) + mean(diag(A1)[101:200]);
A0y1b <- sqrt(100) * sd(A1vec[shalf]) * sin(vl);
points(x = A0x1b, y = A0y1b, type = "l", lwd = 3, col = "grey");
plot(A1_r, A1_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1,
col = "black", yaxt = "n");
text(x = -3.25, y = 3.5, labels = "b", cex = 2);
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
A0 <- read.csv(file = "../sim_results/bi_gamma/S200_A0.csv");
A0 <- as.matrix(A0[,-1]);
A1 <- read.csv(file = "../sim_results/bi_gamma/S200_A1.csv");
A1 <- as.matrix(A1[,-1]);
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(t(A0_vm));
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(t(A1_vm));
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
A0x0 <- sqrt(200) * sd(A0vec) * cos(vl) + mean(diag(A0));
A0y0 <- sqrt(200) * sd(A0vec) * sin(vl);
text(x = -3.25, y = 3.5, labels = "a", cex = 2);
points(x = A0x0, y = A0y0, type = "l", lwd = 3, col = "grey");
points(A0_r, A0_i, pch = 4, cex = 0.7);
plot(A1_r, A1_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1,
col = "black", yaxt = "n");
vl <- seq(from = 0, to = 2*pi, by = 0.001);
fhalf <- 1:(0.5*length(A1vec));
shalf <- (0.5*length(A1vec)+1):length(A1vec);
A0x1a <- sqrt(100) * sd(A1vec[fhalf]) * cos(vl) + mean(diag(A1)[1:100]);
A0y1a <- sqrt(100) * sd(A1vec[fhalf]) * sin(vl);
points(x = A0x1a, y = A0y1a, type = "l", lwd = 3, col = "grey");
A0x1b <- sqrt(100) * sd(A1vec[shalf]) * cos(vl) + mean(diag(A1)[101:200]);
A0y1b <- sqrt(100) * sd(A1vec[shalf]) * sin(vl);
points(x = A0x1b, y = A0y1b, type = "l", lwd = 3, col = "grey");
points(A1_r, A1_i,pch = 4, cex = 0.7);
text(x = -3.25, y = 3.5, labels = "b", cex = 2);
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
A0 <- read.csv(file = "../sim_results/bi_gamma/S200_A0.csv");
A0 <- as.matrix(A0[,-1]);
A1 <- read.csv(file = "../sim_results/bi_gamma/S200_A1.csv");
A1 <- as.matrix(A1[,-1]);
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(t(A0_vm));
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(t(A1_vm));
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
A0x0 <- sqrt(200) * sd(A0vec) * cos(vl) + mean(diag(A0));
A0y0 <- sqrt(200) * sd(A0vec) * sin(vl);
text(x = -3.5, y = 3, labels = "a", cex = 2);
points(x = A0x0, y = A0y0, type = "l", lwd = 3, col = "grey");
points(A0_r, A0_i, pch = 4, cex = 0.7);
plot(A1_r, A1_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1,
col = "black", yaxt = "n");
vl <- seq(from = 0, to = 2*pi, by = 0.001);
fhalf <- 1:(0.5*length(A1vec));
shalf <- (0.5*length(A1vec)+1):length(A1vec);
A0x1a <- sqrt(100) * sd(A1vec[fhalf]) * cos(vl) + mean(diag(A1)[1:100]);
A0y1a <- sqrt(100) * sd(A1vec[fhalf]) * sin(vl);
points(x = A0x1a, y = A0y1a, type = "l", lwd = 3, col = "grey");
A0x1b <- sqrt(100) * sd(A1vec[shalf]) * cos(vl) + mean(diag(A1)[101:200]);
A0y1b <- sqrt(100) * sd(A1vec[shalf]) * sin(vl);
points(x = A0x1b, y = A0y1b, type = "l", lwd = 3, col = "grey");
points(A1_r[1:100], A1_i[1:100],pch = 4, cex = 0.7);
text(x = -3.5, y = 3, labels = "b", cex = 2);
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
stab_bgamma <- function(S = 200, C = 0.05, Osd = 0.4, iters = 10000){
ress <- matrix(data = 0, nrow = iters, ncol = 2);
while(iters > 0){
A_dat  <- rnorm(n = S * S, mean = 0, sd = Osd);
A_mat  <- matrix(data = A_dat, nrow = S);
C_dat  <- rbinom(n = S * S, size = 1, prob = C);
C_mat  <- matrix(data = C_dat, nrow = S, ncol = S);
A_mat  <- A_mat * C_mat;
gammas <- c(rep(1.95, S/2), rep(0.05, S/2))
mu_gam <- mean(gammas);
diag(A_mat) <- -1;
A1     <- gammas * A_mat;
A0     <- mu_gam * A_mat;
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
if(max(A0_r) < 0){
ress[iters, 1] <- 1;
}
if(max(A1_r) < 0){
ress[iters, 2] <- 1;
}
print(iters);
iters <- iters - 1;
}
}
mat <- matrix(data = 0, nrow = 3, ncol = 3);
diag(mat) <- -1;
mat[1,1] <- 0.0001;
mat
mat[1,1] <- 0.01;
mat
eigen(mat)$values
mat[1,2] <- -1;
mat[1,3] <- -1;
eigen(mat)$values
mat[3,1] <- -1;
mat[2,1] <- -1;
eigen(mat)$values
mat[2,1] <- 1;
mat[3,1] <- 1;
eigen(mat)$values
Re(eigen(mat)$values)
mean(diag(mat))
mean(Re(eigen(mat)$values))
var(runif(1000,0,2))
(var(runif(1000,0,2)) + 0.4) * sqrt(1000)
(sd(runif(1000,0,2)) + 0.4) * sqrt(1000)
(0.4) * sqrt(1000)
0.4 * sqrt(32)
0.4 * sqrt(32) - 1
0.4 * sqrt(24) - 1
0.4 * sqrt(25) - 1
dat <- read.csv(file = "sim_results/C_1/random_all.csv");
setwd("~/Dropbox/projects/random_matrix_stability")
setwd("~/Dropbox/projects/random_matrix_stability")
dat <- read.csv(file = "sim_results/C_1/random_all.csv");
head(dat)
dat[,2:6];
54 (54+5)
54 / (54+5)
122 / (7+122)
dat[,1:8];
dat[,6] / dat[,5]
dat <- dat[,-1]
dat[,1:8];
?pander
library(pander)
?pander
library(GMSE)
gmse_gui();
setwd("~/Dropbox/projects/random_matrix_stability")
A0 <- read.csv(file = "sim_results/bi_gamma/S200_A0.csv");
A1 <- read.csv(file = "sim_results/bi_gamma/S200_A1.csv");
head(A0)
A0 <- as.matrix(A0[,-1]);
A1 <- as.matrix(A1[,-1]);
save(A0, A1, file = "data/bg_data.rda");
?save
save(A0, A1, file = "bg_data.rda");
plot_Fig_1 <- function(A0, A1){
A0_e        <- eigen(A0)$values;
A0_r        <- Re(A0_e);
A0_i        <- Im(A0_e);
A1_e        <- eigen(A1)$values;
A1_r        <- Re(A1_e);
A1_i        <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(t(A0_vm));
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(t(A1_vm));
A1vec       <- A1vec[is.na(A1vec) == FALSE];
fhalf       <- 1:(0.5*length(A1vec));
shalf       <- (0.5*length(A1vec)+1):length(A1vec);
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl   <- seq(from = 0, to = 2*pi, by = 0.001);
A0x0 <- sqrt(200) * sd(A0vec) * cos(vl) + mean(diag(A0));
A0y0 <- sqrt(200) * sd(A0vec) * sin(vl);
text(x = -3.5, y = 2.25, labels = "a", cex = 2);
points(x = A0x0, y = A0y0, type = "l", lwd = 3, col = "grey");
points(A0_r, A0_i, pch = 4, cex = 0.7);
plot(A1_r, A1_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1,
col = "black", yaxt = "n");
vl <- seq(from = 0, to = 2*pi, by = 0.001);
A0x1a <- sqrt(100) * sd(A1vec[fhalf]) * cos(vl) + mean(diag(A1)[1:100]);
A0y1a <- sqrt(100) * sd(A1vec[fhalf]) * sin(vl);
points(x = A0x1a, y = A0y1a, type = "l", lwd = 3, col = "grey");
A0x1b <- sqrt(100) * sd(A1vec[shalf]) * cos(vl) + mean(diag(A1)[101:200]);
A0y1b <- sqrt(100) * sd(A1vec[shalf]) * sin(vl);
points(x = A0x1b, y = A0y1b, type = "l", lwd = 3, col = "grey");
points(A1_r[1:100], A1_i[1:100],pch = 4, cex = 0.7);
text(x = -3.5, y = 2.25, labels = "b", cex = 2);
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
}
plot_Fig_1(A0 = A0, A1 = A1)
plot_Fig_1 <- function(A0, A1){
S_val       <- dim(A0)[1];
A0_e        <- eigen(A0)$values;
A0_r        <- Re(A0_e);
A0_i        <- Im(A0_e);
A1_e        <- eigen(A1)$values;
A1_r        <- Re(A1_e);
A1_i        <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(t(A0_vm));
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(t(A1_vm));
A1vec       <- A1vec[is.na(A1vec) == FALSE];
fhalf       <- 1:(0.5*length(A1vec));
shalf       <- (0.5*length(A1vec)+1):length(A1vec);
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl   <- seq(from = 0, to = 2*pi, by = 0.001);
A0x0 <- sqrt(S_val) * sd(A0vec) * cos(vl) + mean(diag(A0));
A0y0 <- sqrt(S_val) * sd(A0vec) * sin(vl);
text(x = -3.5, y = 2.25, labels = "a", cex = 2);
points(x = A0x0, y = A0y0, type = "l", lwd = 3, col = "grey");
points(A0_r, A0_i, pch = 4, cex = 0.7);
plot(A1_r, A1_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1,
col = "black", yaxt = "n");
vl <- seq(from = 0, to = 2*pi, by = 0.001);
A0x1a <- sqrt(0.5*S_val) * sd(A1vec[fhalf]) * cos(vl) + mean(diag(A1)[1:(0.5*S_val)]);
A0y1a <- sqrt(S_val) * sd(A1vec[fhalf]) * sin(vl);
points(x = A0x1a, y = A0y1a, type = "l", lwd = 3, col = "grey");
A0x1b <- sqrt(0.5*S_val) * sd(A1vec[shalf]) * cos(vl) +
mean( diag(A1)[( (0.5*S_val) + 1 ):S_val] );
A0y1b <- sqrt(0.5*S_val) * sd(A1vec[shalf]) * sin(vl);
points(x = A0x1b, y = A0y1b, type = "l", lwd = 3, col = "grey");
points(A1_r[S_val], A1_i[1:S_val],pch = 4, cex = 0.7);
text(x = -3.5, y = 2.25, labels = "b", cex = 2);
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
}
plot_Fig_1(A0 = A0, A1 = A1);
plot_Fig_1 <- function(A0, A1){
S_val       <- dim(A0)[1];
A0_e        <- eigen(A0)$values;
A0_r        <- Re(A0_e);
A0_i        <- Im(A0_e);
A1_e        <- eigen(A1)$values;
A1_r        <- Re(A1_e);
A1_i        <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(t(A0_vm));
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(t(A1_vm));
A1vec       <- A1vec[is.na(A1vec) == FALSE];
fhalf       <- 1:(0.5*length(A1vec));
shalf       <- (0.5*length(A1vec)+1):length(A1vec);
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1);
vl   <- seq(from = 0, to = 2*pi, by = 0.001);
A0x0 <- sqrt(S_val) * sd(A0vec) * cos(vl) + mean(diag(A0));
A0y0 <- sqrt(S_val) * sd(A0vec) * sin(vl);
text(x = -3.5, y = 2.25, labels = "a", cex = 2);
points(x = A0x0, y = A0y0, type = "l", lwd = 3, col = "grey");
points(A0_r, A0_i, pch = 4, cex = 0.7);
plot(A1_r, A1_i, xlim = c(-3.7, 0.3), ylim = c(-2, 2), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1,
col = "black", yaxt = "n");
vl <- seq(from = 0, to = 2*pi, by = 0.001);
A0x1a <- sqrt(0.5*S_val) * sd(A1vec[fhalf]) * cos(vl) + mean(diag(A1)[1:(0.5*S_val)]);
A0y1a <- sqrt(S_val) * sd(A1vec[fhalf]) * sin(vl);
points(x = A0x1a, y = A0y1a, type = "l", lwd = 3, col = "grey");
A0x1b <- sqrt(0.5*S_val) * sd(A1vec[shalf]) * cos(vl) +
mean( diag(A1)[( (0.5*S_val) + 1 ):S_val] );
A0y1b <- sqrt(0.5*S_val) * sd(A1vec[shalf]) * sin(vl);
points(x = A0x1b, y = A0y1b, type = "l", lwd = 3, col = "grey");
points(A1_r[1:S_val], A1_i[1:S_val],pch = 4, cex = 0.7);
text(x = -3.5, y = 2.25, labels = "b", cex = 2);
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
}
plot_Fig_1(A0 = A0, A1 = A1);
pr_st       <- read.csv(file = "sim_results/bi_gamma/bi_pr_st.csv");
save(bi_pr_st, "bi_pr_st.csv");
pr_st -> bi_pr_st
save(bi_pr_st, "bi_pr_st.rda");
save(bi_pr_st, file = "bi_pr_st.rda");
bi_pr_st
plot_Fig_2 <- function(){
A_comp <- NULL;
A_dat  <- rnorm(n = 1000000, mean = 0, sd = 0.4);
A_mat  <- matrix(data = A_dat, nrow = 1000);
C_dat  <- rbinom(n = 1000 * 1000, size = 1, prob = 1);
C_mat  <- matrix(data = C_dat, nrow = 1000, ncol = 1000);
A_mat     <- A_mat * C_mat;
gammas <- runif(n = 1000, min = 0, max = 2);
mu_gam <- mean(gammas);
diag(A_mat) <- -1;
A1     <- gammas * A_mat;
A0     <- mu_gam * A_mat;
A0_e   <- eigen(A0)$values;
A0_r   <- Re(A0_e);
A0_i   <- Im(A0_e);
A1_e   <- eigen(A1)$values;
A1_r   <- Re(A1_e);
A1_i   <- Im(A1_e);
A0_vm       <- A0;
diag(A0_vm) <- NA;
A0vec       <- as.vector(A0_vm);
A0vec       <- A0vec[is.na(A0vec) == FALSE];
A1_vm       <- A1;
diag(A1_vm) <- NA;
A1vec       <- as.vector(A1_vm);
A1vec       <- A1vec[is.na(A1vec) == FALSE];
par(mfrow = c(1, 2), mar = c(0.5, 0.5, 0.5, 0.5), oma = c(5, 5, 0, 0));
plot(A0_r, A0_i, xlim = c(-16.5, 15.5), ylim = c(-16.5,15.5), pch = 4,
cex = 0.7, xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5,
asp = 1);
vl <- seq(from = 0, to = 2*pi, by = 0.001);
x0 <- sqrt(1000) * sd(A0vec) * cos(vl) + mean(diag(A0));
y0 <- sqrt(1000) * sd(A0vec) * sin(vl);
x1 <- sqrt(1000) * sd(A1vec) * cos(vl) + mean(diag(A1));
y1 <- sqrt(1000) * sd(A1vec) * sin(vl);
text(x = -15.5, y = 19, labels = "a", cex = 2);
points(x = x0, y = y0, type = "l", lwd = 3);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3, lty = "dashed");
plot(A1_r, A1_i, xlim = c(-16.5, 15.5), ylim = c(-16.5,15.5), pch = 4, cex = 0.7,
xlab = "", ylab = "", cex.lab = 1.5, cex.axis = 1.5, asp = 1, col = "red",
yaxt = "n");
text(x = -15.5, y = 19, labels = "b", cex = 2);
points(x = x1, y = y1, type = "l", col = "red", lwd = 3)
points(x = x0, y = y0, type = "l", lwd = 3, lty = "dashed");
mtext(side = 1, "Real", outer = TRUE, line = 3, cex = 2);
mtext(side = 2, "Imaginary", outer = TRUE, line = 2.5, cex = 2);
}
plot_Fig_2()
roxygen2::roxygenise()
roxygen2::roxygenise()
