---
title: "Component response rate variation drives stability in large complex systems"
author: "Brad Duthie"
bibliography: references.bib
output:
  html_document: default
  pdf_document:
    fig_caption: yes
  word_document:
    fig_caption: yes
    pandoc_args:
    - --csl
    - evolution.csl
    reference_docx: docx_template.docx
header-includes:
- \usepackage{amsmath}
- \usepackage{natbib}
- \usepackage{lineno}
- \usepackage[utf8]{inputenc}
- \linenumbers
- \bibliographystyle{amnatnat}
linestretch: 1
link-citations: yes
linkcolor: blue
csl: nature.csl
biblio-style: apalike
---

```{r, echo = FALSE}
source(file = "R/sim_mat.R");
source(file = "R/plot_figs.R");
```

********************************************************************************

**The stability of a complex system generally decreases with increasing system size, as is demonstrated by random matrix theory [@May1972; @Allesina2012]. This counter-intuitive result, first shown by May [@May1972], is broadly relevant for understanding the dynamics and persistence of systems such as chemical, biological, and social networks. Much attention has especially been given to the stability of ecological communities such as food webs or mutualist networks, with recent work investigating how different community structures affect stability [@Haldane2011; @Allesina2012; @Mougi2012; @Allesina2015a; @Gao2016; @Grilli2017; @Patel2018]. But more broadly, stabilising mechanisms in complex systems remain under-developed, and the effect of variation in the response rate of individual system components remains unexplored. Here I show that when components of a complex system respond to system dynamics at different rates, system stability is markedly increased. This increase in stability is especially strong when variation in component response rate ($\gamma$) is high and has a skewed distribution. Further, these effects become increasingly important as system size increases, to the extent that the largest stable complex systems would otherwise be unstable if not for variation in $\gamma$. My results therefore reveal a previously unconsidered driver of system stability that is likely to be pervasive across all complex systems. Future research in complex systems should therefore account for the varying response rates of individual system components when assessing whole system stability.** 



**References**

<div id="refs"></div>

********************************************************************************

**Figure 1: Distributions of component response rate ($\boldsymbol{\gamma}$) values in complex systems.** The stabilities of simulated complex systems with these $\gamma$ distributions are compared to otherwise identical complex systems with a fixed component response rate of $\gamma = 1$ across different system sizes ($S$; i.e., component numbers) given a unit $\gamma$ standard deviation ($\sigma_{\gamma} = 1$). Distributions are as follows: (a) uniform, (b) exponential, (c) beta ($\alpha = 0.5$ and $\beta = 0.5$), and (d) gamma ($k = 2$ and $\theta = 2$). Each panel shows 1 million randomly generated $\gamma$ values.

```{r, eval = TRUE, echo = FALSE, fig.height = 8}
show_gammas();
```

********************************************************************************

```{r, eval = TRUE, echo = FALSE}
eig_cloud <- eigen_cloud(sp = 20, iters = 10000);
Pr_D0     <- sum(eig_cloud$d0[,1] < 0) / length(eig_cloud$d0[,1]);
Pr_D1     <- sum(eig_cloud$d1[,1] < 0) / length(eig_cloud$d1[,1]);
Pr_D2     <- sum(eig_cloud$d2[,1] < 0) / length(eig_cloud$d2[,1]);
Pr_D3     <- sum(eig_cloud$d3[,1] < 0) / length(eig_cloud$d3[,1]);
Pr_D4     <- sum(eig_cloud$d4[,1] < 0) / length(eig_cloud$d4[,1]);
```

**Figure 2: Distributions of eigenvalues across different distributions of component response rate  ($\boldsymbol{\gamma}$) values.** Panels show 100000 random communities for $S = 20$ and $C = 1$, where off-diagonal elements are randomly sampled from a standard normal distribution $N(0, 1)$, diagonal elements are $-1$, and each row of elements is multiplied by a random scalar value $\gamma$ sampled from one of four distributions (black points in all sub-panels):  **a**, uniform $\Pr(\gamma = x) = 1/\sqrt{12}$ where $x \in [0, \sqrt{12}]$. **b**, exponential $\Pr(\gamma = x) = e^{-x}$ where $x \geq 0$. **c**, beta $\Pr(\gamma = x) = \frac{x^{\alpha - 1}(1-x)^{\beta - 1}}{B(\alpha, \beta)}$ where $x \in [0, 1]$, and where $B(\alpha, \beta) = \frac{\Gamma(\alpha)\Gamma(\beta)}{\Gamma(\alpha + \beta)}$ for $\alpha = 0.5$ and $\beta = 0.5$. **d**, gamma $\Pr(\gamma = x) = \frac{1}{\Gamma(k)\theta^{k}}x^{k-1}e^{\frac{-x}{\theta}}$ for $k = 2$ and $\theta = 2$, where $x \in [0, 1]$. Eigenvalues associated with each $\gamma$ distribution are compared with otherwise identical communities in which $\gamma = 1$ (pink points in all sub-panels). In all distributions, $SD(\gamma) = 1$; note that $\gamma$ distributions cannot be mean standardised without changing the sign of some community matrix elements, but the sign of eigenvalues (and therefore community stability) is unaffected by multiplying elements by any scalar value. Proportions of real components of eigenvalues (x-axis) below 0 are (a) `r Pr_D1`, (b) `r Pr_D2`, (c) `r Pr_D3`, (d) `r Pr_D4`, as compared to `r Pr_D0` when $\gamma = 1$.

```{r, eval = TRUE, echo = FALSE, fig.height = 8}
eig_plot(ecl = eig_cloud);
```

********************************************************************************


